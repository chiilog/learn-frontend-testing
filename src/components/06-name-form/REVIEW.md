# 📝 テスト & 実装 添削コメント - 06-name-form

---

## ✅ テストの良かった点

### ✅ ユーザー操作の流れを丁寧に再現している

- `userEvent.type` と `userEvent.click` の順序が自然で、ユーザー視点のシナリオに沿ったテストになっている。

### ✅ テストケースが網羅的で適切

- 初期状態、入力による状態変化、送信後の状態リセットのすべてをしっかり確認している。

### ✅ `mockCallback` のクリアを `beforeEach` にまとめていて、テスト間の干渉を防いでいるのがGood！

---

## 🛠 テスト改善ポイント（任意）

### 🔹 `expect(mockCallback).toHaveBeenCalledWith(...)` を追加できるとより堅牢

- 現在は「呼ばれたか」だけを確認しているが、渡された引数も確認するとテストの精度が上がる。

```ts
expect(mockCallback).toHaveBeenCalledWith('test');
```

※ そのためには `onSubmit` に `name: string` を引数として受け取るようにすると良い。

---

## ✅ コンポーネント実装の良かった点

### ✅ 状態管理がシンプルで読みやすい

- `username` の状態と `setUsername` の処理が直感的で、初心者にも理解しやすい実装になっている。

### ✅ 入力の有無でボタンの有効／無効を制御していて、UI的にも自然な体験を提供できている。

### ✅ `onSubmit()` の後に `setUsername('')` を呼んでいて、フォームのリセット挙動もばっちり。

---

## 🛠 実装改善ポイント（任意）

### 🔹 `onSubmit` に引数を渡せるようにすることで、より現実的なフォームに近づける

```ts
onSubmit(username);
```

→ 実務では「フォームから得た値を使って何か処理する」ことが多いため、より応用しやすいコードになる。

### 🔹 `<form>` に `onSubmit={handleSubmit}` を直接渡すと、HTMLフォームとしての自然な挙動に近づく

```tsx
<form onSubmit={(e) => { e.preventDefault(); handleSubmit(); }}>
```

→ `type="submit"` も使えるようになり、アクセシビリティも向上する（ただし `requestSubmit` の回避には工夫が必要）

---

## 💬 総評

- テスト・実装ともに非常に丁寧で、**React × フォーム × ユーザー操作の基本**がしっかり身についています！
- UIテストにおいて大事な「ユーザーの視点でどう見えるか？」という観点がちゃんと反映されているのが素晴らしいです。
- この調子で次は「フォームのエラーメッセージ」や「複数入力項目」など、少しずつリアルなユースケースに近づけていきましょう🔥

---

## ❗️備考：テスト中の `requestSubmit` エラーについて

今回の環境では、ボタンの `type="submit"` を避け、`type="button"` にすることで `form.requestSubmit()` の発火を防ぎ、`jsdom` の未実装エラーを回避しています。

### ✅ この判断は正解！

- テストを安定させるための**実践的な回避策**として有効
- 本番コードに影響がなければ、**あえて `form` を使わずに構成するのもアリ**

### 🔧 ただし将来的に `onSubmit` を `<form>` に使いたい場合は：

- `form.onSubmit` に `e.preventDefault()` を入れる
- `@testing-library/user-event` のバージョンを下げる（v13系）
- または `form.requestSubmit` をテスト環境で **完全にモック**する必要があります（今の `jsdom` では未対応）

現状の選択は問題なく、学習のフェーズとしてもベストです！
